bplist00Ñ_WebMainResourceÕ	
_WebResourceFrameName^WebResourceURL_WebResourceTextEncodingName_WebResourceData_WebResourceMIMETypeP_capacitor://localhostUUTF-8OW<!DOCTYPE html><head><meta charset="UTF-8"></head><span style="caret-color: rgba(0, 0, 0, 0.87); color: rgba(0, 0, 0, 0.87); font-family: Roboto, Helvetica, Arial, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.13132px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: pre; widows: auto; word-spacing: 0px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.3); -webkit-text-size-adjust: 100%; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration: none; display: inline !important; float: none;">&lt;!DOCTYPE html&gt;
&lt;html lang="zh-CN"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;ğŸ’• çœŸå¿ƒè¯å¤§å†’é™© - å¤šäººåœ¨çº¿&lt;/title&gt;
    &lt;style&gt;
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .card {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            margin-bottom: 20px;
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .room-code {
            text-align: center;
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            letter-spacing: 5px;
        }

        .players-list {
            margin: 20px 0;
        }

        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .player-item.current {
            background: #e3f2fd;
            border: 2px solid #667eea;
        }

        .player-name {
            font-weight: bold;
        }

        .player-score {
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
        }

        #wheelCanvas {
            display: block;
            margin: 20px auto;
            border-radius: 50%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .task-display {
            font-size: 1.3em;
            line-height: 1.6;
            padding: 20px;
            background: #fff3e0;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .message {
            padding: 10px;
            margin: 10px 0;
            border-radius: 10px;
            background: #f5f5f5;
        }

        .message.system {
            background: #e3f2fd;
            text-align: center;
            color: #1976d2;
        }

        .hide {
            display: none;
        }

        .copy-btn {
            background: #4caf50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 10px;
        }

        .divider {
            text-align: center;
            margin: 20px 0;
            color: #999;
            position: relative;
        }

        .divider::before,
        .divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: #ddd;
        }

        .divider::before { left: 0; }
        .divider::after { right: 0; }

        #chatMessages {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .spin-btn {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            border: none;
            color: white;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            display: block;
            margin: 20px auto;
            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.4);
            transition: all 0.3s;
        }

        .spin-btn:hover:not(:disabled) {
            transform: scale(1.1);
        }

        .spin-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="container"&gt;
        &lt;!-- ç™»å½•ç•Œé¢ --&gt;
        &lt;div id="loginScreen" class="card"&gt;
            &lt;h1&gt;ğŸ’• çœŸå¿ƒè¯å¤§å†’é™©&lt;/h1&gt;
            &lt;div class="input-group"&gt;
                &lt;label&gt;ä½ çš„æ˜µç§°&lt;/label&gt;
                &lt;input type="text" id="nicknameInput" placeholder="è¾“å…¥æ˜µç§°" maxlength="10"&gt;
            &lt;/div&gt;
            &lt;button class="btn btn-primary" onclick="createRoom()"&gt;åˆ›å»ºæˆ¿é—´&lt;/button&gt;
            
            &lt;div class="divider"&gt;æˆ–&lt;/div&gt;
            
            &lt;div class="input-group"&gt;
                &lt;label&gt;æˆ¿é—´ç &lt;/label&gt;
                &lt;input type="text" id="roomCodeInput" placeholder="è¾“å…¥6ä½æˆ¿é—´ç " maxlength="6"&gt;
            &lt;/div&gt;
            &lt;button class="btn btn-secondary" onclick="joinRoom()"&gt;åŠ å…¥æˆ¿é—´&lt;/button&gt;
        &lt;/div&gt;

        &lt;!-- æ¸¸æˆç•Œé¢ --&gt;
        &lt;div id="gameScreen" class="hide"&gt;
            &lt;div class="card"&gt;
                &lt;h1&gt;æˆ¿é—´ç &lt;/h1&gt;
                &lt;div class="room-code" id="displayRoomCode"&gt;&lt;/div&gt;
                &lt;button class="copy-btn" onclick="copyRoomCode()"&gt;ğŸ“‹ å¤åˆ¶æˆ¿é—´ç &lt;/button&gt;
                &lt;button class="btn btn-secondary" onclick="leaveRoom()"&gt;ğŸšª é€€å‡ºæˆ¿é—´&lt;/button&gt;
            &lt;/div&gt;

            &lt;div class="card"&gt;
                &lt;h2&gt;ğŸ‘¥ ç©å®¶ (&lt;span id="playerCount"&gt;0&lt;/span&gt;äºº)&lt;/h2&gt;
                &lt;div class="players-list" id="playersList"&gt;&lt;/div&gt;
            &lt;/div&gt;

            &lt;div class="card"&gt;
                &lt;h2&gt;ğŸ¯ æ¸¸æˆåŒºåŸŸ&lt;/h2&gt;
                &lt;p style="text-align: center; margin: 15px 0; color: #666;" id="turnInfo"&gt;
                    ç­‰å¾…ç©å®¶...
                &lt;/p&gt;
                &lt;canvas id="wheelCanvas" width="300" height="300"&gt;&lt;/canvas&gt;
                &lt;button class="spin-btn" id="spinBtn" onclick="spinWheel()" disabled&gt;
                    å¼€å§‹
                &lt;/button&gt;
                &lt;div id="taskDisplay" class="task-display hide"&gt;&lt;/div&gt;
                &lt;div id="actionButtons" class="hide"&gt;
                    &lt;button class="btn btn-primary" onclick="completeTask()"&gt;âœ… å®Œæˆäº†&lt;/button&gt;
                    &lt;button class="btn btn-secondary" onclick="skipTask()"&gt;â­ï¸ è·³è¿‡&lt;/button&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class="card"&gt;
                &lt;h2&gt;ğŸ’¬ èŠå¤©&lt;/h2&gt;
                &lt;div id="chatMessages"&gt;&lt;/div&gt;
                &lt;div style="display: flex; gap: 10px;"&gt;
                    &lt;input type="text" id="chatInput" placeholder="è¾“å…¥æ¶ˆæ¯..." 
                           style="flex: 1; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;"
                           onkeypress="if(event.key==='Enter') sendMessage()"&gt;
                    &lt;button class="btn btn-primary" style="width: auto; padding: 10px 20px; margin: 0;" 
                            onclick="sendMessage()"&gt;å‘é€&lt;/button&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;!-- Firebase --&gt;
    &lt;script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"&gt;&lt;/script&gt;
    &lt;script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"&gt;&lt;/script&gt;

    &lt;script&gt;
        // Firebase é…ç½®ï¼ˆä½¿ç”¨æ¼”ç¤ºé…ç½®ï¼Œä½ éœ€è¦æ›¿æ¢æˆè‡ªå·±çš„ï¼‰
        const firebaseConfig = {
            apiKey: "AIzaSyDemoKey123456789",  // æ›¿æ¢æˆä½ çš„
            authDomain: "your-app.firebaseapp.com",
            databaseURL: "https://your-app-default-rtdb.firebaseio.com",
            projectId: "your-app",
            storageBucket: "your-app.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abc123"
        };

        // åˆå§‹åŒ– Firebase
        let app, db;
        try {
            app = firebase.initializeApp(firebaseConfig);
            db = firebase.database();
        } catch (e) {
            console.error('Firebaseåˆå§‹åŒ–å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°æ¨¡å¼');
        }

        // é¢˜åº“
        const tasks = {
            sweetTruth: [
                "ä»€ä¹ˆæ—¶å€™å¼€å§‹å–œæ¬¢æˆ‘çš„ï¼Ÿ",
                "å·å·ç»™æˆ‘çš„å¤‡æ³¨æ˜¯ä»€ä¹ˆï¼Ÿ",
                "è§‰å¾—æˆ‘æœ€æ€§æ„Ÿçš„éƒ¨ä½æ˜¯ï¼Ÿ",
                "ç¬¬ä¸€æ¬¡è§æˆ‘æ—¶çš„çœŸå®æƒ³æ³•ï¼Ÿ",
                "æœ€å–œæ¬¢æˆ‘çš„å“ªä¸ªè¡¨æƒ…ï¼Ÿ"
            ],
            funnyDare: [
                "å­¦5ç§åŠ¨ç‰©å«",
                "ç”¨å®¶ä¹¡è¯å”±æ­Œ",
                "æ¨¡ä»¿æŸäººè¯´è¯1åˆ†é’Ÿ",
                "å‘æœ‹å‹åœˆå¤¸æ‰€æœ‰äºº",
                "è¡¨æ¼”æ‰è‰º"
            ],
            excitingDare: [
                "äº¤å‡ºæ‰‹æœº5åˆ†é’Ÿ",
                "å‘ä¸‘ç…§åˆ°æœ‹å‹åœˆ",
                "ç»™å‰ä»»å‘æ¶ˆæ¯",
                "æ‰¿åŒ…ä¸‹æ¬¡èšä¼šè´¹ç”¨",
                "å”±å®Œæ•´çš„æƒ…æ­Œ"
            ]
        };

        const wheelSections = [
            { name: 'ç”œèœœçœŸå¿ƒè¯', color: '#ffc9e7', type: 'sweetTruth' },
            { name: 'æç¬‘å¤§å†’é™©', color: '#fff59d', type: 'funnyDare' },
            { name: 'åˆºæ¿€å¤§å†’é™©', color: '#ff8a80', type: 'excitingDare' }
        ];

        let gameState = {
            roomCode: '',
            myId: '',
            myNickname: '',
            roomRef: null
        };

        // ç”Ÿæˆæˆ¿é—´ç 
        function generateRoomCode() {
            return Math.random().toString(36).substring(2, 8).toUpperCase();
        }

        // åˆ›å»ºæˆ¿é—´
        async function createRoom() {
            const nickname = document.getElementById('nicknameInput').value.trim();
            if (!nickname) {
                alert('è¯·è¾“å…¥æ˜µç§°ï¼');
                return;
            }

            gameState.roomCode = generateRoomCode();
            gameState.myId = Date.now().toString();
            gameState.myNickname = nickname;

            if (db) {
                gameState.roomRef = db.ref('rooms/' + gameState.roomCode);
                await gameState.roomRef.set({
                    players: {
                        [gameState.myId]: {
                            nickname: nickname,
                            score: 0,
                            online: true,
                            joinedAt: Date.now()
                        }
                    },
                    currentTurn: 0,
                    playerOrder: [gameState.myId],
                    currentTask: null,
                    createdAt: Date.now()
                });

                listenToRoom();
            }

            enterGame();
        }

        // åŠ å…¥æˆ¿é—´
        async function joinRoom() {
            const nickname = document.getElementById('nicknameInput').value.trim();
            const roomCode = document.getElementById('roomCodeInput').value.trim().toUpperCase();

            if (!nickname || !roomCode) {
                alert('è¯·è¾“å…¥æ˜µç§°å’Œæˆ¿é—´ç ï¼');
                return;
            }

            if (db) {
                gameState.roomRef = db.ref('rooms/' + roomCode);
                const snapshot = await gameState.roomRef.once('value');
                
                if (!snapshot.exists()) {
                    alert('æˆ¿é—´ä¸å­˜åœ¨ï¼');
                    return;
                }

                gameState.roomCode = roomCode;
                gameState.myId = Date.now().toString();
                gameState.myNickname = nickname;

                await gameState.roomRef.child('players/' + gameState.myId).set({
                    nickname: nickname,
                    score: 0,
                    online: true,
                    joinedAt: Date.now()
                });

                const playerOrder = snapshot.val().playerOrder || [];
                playerOrder.push(gameState.myId);
                await gameState.roomRef.child('playerOrder').set(playerOrder);

                addMessage('system', `${nickname} åŠ å…¥äº†æˆ¿é—´`);
                listenToRoom();
            }

            enterGame();
        }

        // ç›‘å¬æˆ¿é—´å˜åŒ–
        function listenToRoom() {
            if (!gameState.roomRef) return;

            gameState.roomRef.on('value', (snapshot) =&gt; {
                const data = snapshot.val();
                if (!data) return;

                updatePlayersDisplay(data);
                updateGameState(data);
            });

            // ç›‘å¬èŠå¤©
            gameState.roomRef.child('messages').on('child_added', (snapshot) =&gt; {
                const msg = snapshot.val();
                addMessage(msg.type, msg.text, msg.sender);
            });
        }

        // è¿›å…¥æ¸¸æˆ
        function enterGame() {
            document.getElementById('loginScreen').classList.add('hide');
            document.getElementById('gameScreen').classList.remove('hide');
            document.getElementById('displayRoomCode').textContent = gameState.roomCode;
            drawWheel();
        }

        // ç»˜åˆ¶è½®ç›˜
        function drawWheel() {
            const canvas = document.getElementById('wheelCanvas');
            const ctx = canvas.getContext('2d');
            const centerX = 150;
            const centerY = 150;
            const radius = 140;

            let angle = 0;
            const sectionAngle = (2 * Math.PI) / wheelSections.length;

            wheelSections.forEach(section =&gt; {
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, angle, angle + sectionAngle);
                ctx.closePath();
                ctx.fillStyle = section.color;
                ctx.fill();
                ctx.strokeStyle = 'white';
                ctx.lineWidth = 2;
                ctx.stroke();

                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(angle + sectionAngle / 2);
                ctx.textAlign = 'center';
                ctx.fillStyle = '#333';
                ctx.font = 'bold 12px Arial';
                ctx.fillText(section.name, radius * 0.6, 0);
                ctx.restore();

                angle += sectionAngle;
            });
        }

        // æ›´æ–°ç©å®¶æ˜¾ç¤º
        function updatePlayersDisplay(data) {
            const container = document.getElementById('playersList');
            const players = data.players || {};
            const playerOrder = data.playerOrder || [];
            const currentTurnIndex = data.currentTurn || 0;
            const currentPlayerId = playerOrder[currentTurnIndex];

            container.innerHTML = '';
            document.getElementById('playerCount').textContent = Object.keys(players).length;

            playerOrder.forEach(playerId =&gt; {
                const player = players[playerId];
                if (!player) return;

                const div = document.createElement('div');
                div.className = `player-item ${playerId === currentPlayerId ? 'current' : ''}`;
                div.innerHTML = `
                    &lt;span class="player-name"&gt;
                        ${player.nickname} ${playerId === gameState.myId ? '(ä½ )' : ''}
                        ${playerId === currentPlayerId ? 'ğŸ¯' : ''}
                    &lt;/span&gt;
                    &lt;span class="player-score"&gt;${player.score || 0}åˆ†&lt;/span&gt;
                `;
                container.appendChild(div);
            });
        }

        // æ›´æ–°æ¸¸æˆçŠ¶æ€
        function updateGameState(data) {
            const playerOrder = data.playerOrder || [];
            const currentTurnIndex = data.currentTurn || 0;
            const currentPlayerId = playerOrder[currentTurnIndex];
            const isMyTurn = currentPlayerId === gameState.myId;

            document.getElementById('turnInfo').textContent = 
                isMyTurn ? 'è½®åˆ°ä½ äº†ï¼ç‚¹å‡»å¼€å§‹' : `ç­‰å¾… ${data.players[currentPlayerId]?.nickname} è½¬åŠ¨è½®ç›˜...`;

            document.getElementById('spinBtn').disabled = !isMyTurn;

            if (data.currentTask) {
                document.getElementById('taskDisplay').textContent = data.currentTask;
                document.getElementById('taskDisplay').classList.remove('hide');
                document.getElementById('actionButtons').classList.toggle('hide', !isMyTurn);
            } else {
                document.getElementById('taskDisplay').classList.add('hide');
                document.getElementById('actionButtons').classList.add('hide');
            }
        }

        // è½¬åŠ¨è½®ç›˜
        async function spinWheel() {
            const section = wheelSections[Math.floor(Math.random() * wheelSections.length)];
            const taskList = tasks[section.type];
            const task = taskList[Math.floor(Math.random() * taskList.length)];

            if (gameState.roomRef) {
                await gameState.roomRef.child('currentTask').set(task);
                addMessage('system', `ä»»åŠ¡ï¼š${task}`);
            }
        }

        // å®Œæˆä»»åŠ¡
        async function completeTask() {
            if (gameState.roomRef) {
                const snapshot = await gameState.roomRef.once('value');
                const data = snapshot.val();
                const playerOrder = data.playerOrder;
                const nextTurn = (data.currentTurn + 1) % playerOrder.length;

                await gameState.roomRef.update({
                    currentTurn: nextTurn,
                    currentTask: null
                });

                await gameState.roomRef.child(`players/${gameState.myId}/score`).set(
                    (data.players[gameState.myId].score || 0) + 10
                );

                addMessage('system', `${gameState.myNickname} å®Œæˆäº†ä»»åŠ¡ï¼+10åˆ†`);
            }
        }

        // è·³è¿‡ä»»åŠ¡
        async function skipTask() {
            if (gameState.roomRef) {
                const snapshot = await gameState.roomRef.once('value');
                const data = snapshot.val();
                const playerOrder = data.playerOrder;
                const nextTurn = (data.currentTurn + 1) % playerOrder.length;

                await gameState.roomRef.update({
                    currentTurn: nextTurn,
                    currentTask: null
                });

                addMessage('system', `${gameState.myNickname} è·³è¿‡äº†ä»»åŠ¡`);
            }
        }

        // å‘é€æ¶ˆæ¯
        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const text = input.value.trim();
            if (!text) return;

            if (gameState.roomRef) {
                await gameState.roomRef.child('messages').push({
                    type: 'user',
                    text: text,
                    sender: gameState.myNickname,
                    timestamp: Date.now()
                });
            }

            input.value = '';
        }

        // æ·»åŠ æ¶ˆæ¯
        function addMessage(type, text, sender) {
            const container = document.getElementById('chatMessages');
            const div = document.createElement('div');
            div.className = `message ${type}`;
            div.textContent = type === 'system' ? text : `${sender}: ${text}`;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        // å¤åˆ¶æˆ¿é—´ç 
        function copyRoomCode() {
            navigator.clipboard.writeText(gameState.roomCode);
            alert('æˆ¿é—´ç å·²å¤åˆ¶ï¼');
        }

        // ç¦»å¼€æˆ¿é—´
        async function leaveRoom() {
            if (gameState.roomRef) {
                await gameState.roomRef.child('players/' + gameState.myId).remove();
                addMessage('system', `${gameState.myNickname} ç¦»å¼€äº†æˆ¿é—´`);
            }
            location.reload();
        }
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</span>Ytext/html    ( ? N l ~ ” • ­ ³WÃ                           WÍ